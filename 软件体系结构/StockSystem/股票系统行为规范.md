# 股票系统行为规范

## **1. 登录**

打开客户端首先弹出登录框，输入**用户名和密码**

- 客户端向服务器发送包含【用户名和密码】的登录请求，进入等待【用户信息】状态。
-  服务器(交易所)根据用户名读取文件(User/userid.txt)，验证用户名密码正确
- 交易所像客户端发送包含【用户信息】的对象，客户端根据数据包解析得到登录的用户信息，并显示在相关位置

## 2. 购买/卖出股票

客户端点击*购买*按钮，输入购买**购买/卖出股票的id和数量**，调用User::buy(sell)函数

User::buy()中，向服务器发送包含【用户id，股票id，数量】的购买请求，然后进入等待返回【新用户信息】状态。

交易所根据收到的购买信息，验证用户余额充足、持股充足、交易所股票剩余充足等信息，刷新数据库中对应用户信息，刷新内存中的股票信息。（股票信息自交易所开机之后一直保存在交易所内存中，交易所退出程序之时将内存中的股票信息覆盖写入到股票信息文件中）返回发送【用户信息】。

客户端接收到新的用户信息之后刷新本地用户信息。

## 3. 添加关注

客户端点击*添加关注*按钮后，输入添加关注的股票id，调用User::addCare()函数

向服务器发送包含【用户id，关注股票id】的关注请求，随即进入等待返回【新用户信息】状态

交易所根据接收到的关注信息，直接刷新数据库中的用户信息文件，并返回【新用户信息】。

## 4. 显示股票信息

交易所每10s调整一次，发送全部股票信息。

客户端持续接收全部信息，根据持有和关注分别在两个框中进行显示。

同时接受槽函数响应。(这是主要问题，要求客户端能够循环不停的接收股票信息，同时接受界面的点击能够调用槽函数)



## 5. 交易所活动

循环接收各种类型的信息，根据接收的信息做出相应的回应，具体行为基本包含在上述几点中，如有遗漏，自行补充